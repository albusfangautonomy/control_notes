<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Pole Placement and Optimal Control | Albus’s Control Notes</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Pole Placement and Optimal Control" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<link rel="canonical" href="https://albusfangautonomy.github.io/control_notes/notes/pole_placement.html" />
<meta property="og:url" content="https://albusfangautonomy.github.io/control_notes/notes/pole_placement.html" />
<meta property="og:site_name" content="Albus’s Control Notes" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Pole Placement and Optimal Control" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","headline":"Pole Placement and Optimal Control","url":"https://albusfangautonomy.github.io/control_notes/notes/pole_placement.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/control_notes/assets/main.css">
  <link rel="stylesheet" href="/control_notes/assets/css/custom.css"><link type="application/atom+xml" rel="alternate" href="https://albusfangautonomy.github.io/control_notes/feed.xml" title="Albus&apos;s Control Notes" /><script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      }
    };
  </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>

</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/control_notes/">Albus&#39;s Control Notes</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          <a class="page-link" href="/control_notes/">Home</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <h1 id="pole-placement">Pole Placement</h1>
<h2 id="linear-system">Linear system</h2>
<p>For the controllable linear system, 
\(\dot{x} = Ax+Bu,
u=-Kx,
\dot{x}=(A-BK)x\),</p>

<p>there’s a trade off between convergence rate (eigenvalues or poles) and system jerkiness, ie, more negative real parts would lead to faster convergence to stability but sacrifice system response smoothness. Linear Quadratic Regulator (LQR) can be used to find optimal point.</p>

<hr />

<h3 id="poles-to-the-far-left-of-the-complex-plane">Poles to the far left of the complex plane:</h3>
<p>Pro:</p>
<ol>
  <li>Faster Response</li>
  <li>Increased stability margin</li>
</ol>

<p>Cons:</p>
<ol>
  <li>Control effort becomes large. Actuators may saturate.</li>
  <li>Sensitivity to Noise and model uncretainty. High gain feedback amplified measurement noise and unmodeled dynamics</li>
  <li>Numerical instability</li>
  <li>Reduced Robustness</li>
</ol>

<hr />

<h1 id="linear-quadratic-regulator">Linear Quadratic Regulator</h1>
<h2 id="formulation">Formulation</h2>
<p>Cost function \(J=\int_{0}^{\infty}(x^TQx + u^TRu)dt\), where Q is positive semidefinite and x and u are dependet on t. There are <strong>two</strong> components of the cost:</p>
<ol>
  <li>first term penalizes difference between desired state and actual state, which accelerates convergence.</li>
  <li>second term penalizes bigger u - for instance, gas may be expensive and the cost cannot be exorbitant.
The term <strong>linear</strong> refers to \(u=-Kx\), which is a linear controller; <strong>Quadratic</strong> refers to the Cost function; <strong>Regulator</strong> means this stabilizes the system.</li>
</ol>

<h2 id="local-stabilization-of-nonlinear-systems-general-result">Local stabilization of nonlinear systems (General Result)</h2>
<p>Given the nonlinear auitonomous system \(\dot{\mathbf{x}} = f(\mathbf{x}, \mathbf{u})\) and a stabilizable operating point, 
\((\mathbf{x}_0, \mathbf{u}_0)\) 
with 
\(f(\mathbf{x}_0,\mathbf{u}_0) = 0.\)</p>

<p>We can define a relative coordinate system 
\(\bar{\mathbf{x}} = \mathbf{x} - \mathbf{x}_0, \quad \bar{\mathbf{u}} = \mathbf{u} - \mathbf{u}_0.\)</p>

<p>Observe that 
\(\dot{\bar{\mathbf{x}}} = \dot{\mathbf{x}} = f(\mathbf{x}, \mathbf{u})\) 
which we can approximate with a first-order Taylor series to</p>

\[\dot{\bar{\mathbf{x}}} \approx 
f(\mathbf{x}_0,\mathbf{u}_0) + 
\frac{\partial f(\mathbf{x}_0,\mathbf{u}_0)}{\partial \mathbf{x}}(\mathbf{x} - \mathbf{x}_0) + 
\frac{\partial f(\mathbf{x}_0,\mathbf{u}_0)}{\partial \mathbf{u}}(\mathbf{u} - \mathbf{u}_0) 
= A \bar{\mathbf{x}} + B \bar{\mathbf{u}}\]

<p>where \(A\) and \(B\) are the Jacobian matrices.</p>

<p>The resulting controller takes the form 
\(\bar{\mathbf{u}}^* = -K \bar{\mathbf{x}}\)</p>

<p>or</p>

\[\boxed{\mathbf{u}^* = \mathbf{u}_0 - K(\mathbf{x} - \mathbf{x}_0) = \mathbf{u}_0 - K*{\mathbf{e_state}}}\]

<hr />

<h1 id="lqr-example">LQR example</h1>
<h2 id="cartpole">Cartpole</h2>
<h3 id="generlized-coordinates">Generlized coordinates</h3>
<p>\(x\) and \(theta\), both scalars. \(\mathbf{q} = [x, \theta]^T\). \(\dot{\mathbf{q}} = [\dot{x}, \dot{\theta}]^T\)</p>

<p>\(\mathbf{x} = [q, \dot{q}]^T\), \(\mathbf{x_0} = [0, \pi, 0, 0 ]^T\)</p>

<h2 id="linear-quadratic-estimator">Linear Quadratic Estimator</h2>
<p>The Kalman filter is an example of an LQE. More details are in State Estimation page.</p>

<hr />

<h2 id="brysons-rule-for-initial-q-and-r-in-lqr">Bryson’s Rule for Initial \(Q\) and \(R\) in LQR</h2>

<p>Bryson’s Rule is a practical heuristic for choosing initial values for the weighting matrices \(Q\) and \(R\) in LQR when you don’t yet have a fine-tuned cost function.</p>

<hr />

<h3 id="rule"><strong>Rule</strong></h3>
<p>The idea is to scale each state and input so that their <strong>maximum acceptable excursion</strong> corresponds to a cost of 1 in the LQR objective:</p>

<p>\(Q_{ii} = \frac{1}{x_{i,\text{max}}^2}\)
\(R_{jj} = \frac{1}{u_{j,\text{max}}^2}\)</p>

<p>Where:</p>
<ul>
  <li>\(x_{i,\text{max}}\) = maximum tolerable value of state \(i\) (in magnitude)</li>
  <li>\(u_{j,\text{max}}\) = maximum tolerable value of control input \(j\) (in magnitude)</li>
</ul>

<hr />

<h3 id="procedure"><strong>Procedure</strong></h3>
<ol>
  <li><strong>Decide performance limits</strong>
    <ul>
      <li>For each state \(x_i\), choose the largest magnitude you’re willing to allow.</li>
      <li>For each control \(u_j\), choose the largest magnitude you can apply (actuator limit or desired bound).</li>
    </ul>
  </li>
  <li><strong>Build \(Q\)</strong>
    <ul>
      <li>Place \(Q_{ii} = 1 / x_{i,\max}^2\) on the diagonal.</li>
      <li>If you want to weight some states more heavily, increase their \(Q_{ii}\).</li>
    </ul>
  </li>
  <li><strong>Build \(R\)</strong>
    <ul>
      <li>Place \(R_{jj} = 1 / u_{j,\max}^2\) on the diagonal.</li>
      <li>Increasing \(R_{jj}\) penalizes control usage more.</li>
    </ul>
  </li>
  <li><strong>Run LQR</strong>
    <ul>
      <li>Solve the algebraic Riccati equation for \(K\).</li>
      <li>If the closed-loop behavior is too aggressive → increase \(R\).<br />
If it’s too sluggish → decrease \(R\) or increase \(Q\).</li>
    </ul>
  </li>
</ol>

<hr />

<h3 id="example"><strong>Example</strong></h3>
<p>Say you have a 2-state system: position \(p\) and velocity \(v\), and 1 control \(u\).</p>
<ul>
  <li>Max tolerable \(p\): 0.2 m</li>
  <li>Max tolerable \(v\): 0.5 m/s</li>
  <li>Max control \(u\): 2 N</li>
</ul>

\[Q = \begin{bmatrix}
1/(0.2)^2 &amp; 0 \\
0 &amp; 1/(0.5)^2
\end{bmatrix}
= \begin{bmatrix}
25 &amp; 0 \\
0 &amp; 4
\end{bmatrix}\]

\[R = [ 1/(2)^2 ] = [ 0.25 ]\]

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/control_notes/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Albus&#39;s Control Notes</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Albus&#39;s Control Notes</li><li><a class="u-email" href="mailto:albus.fang.autonomy@gmail.com">albus.fang.autonomy@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/control_notes/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/control_notes/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
