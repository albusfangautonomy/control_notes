<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Frequency Response and Fourier Transform | Albus’s Control Notes</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Frequency Response and Fourier Transform" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<link rel="canonical" href="http://localhost:4000/notes/frequency-response.html" />
<meta property="og:url" content="http://localhost:4000/notes/frequency-response.html" />
<meta property="og:site_name" content="Albus’s Control Notes" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Frequency Response and Fourier Transform" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","headline":"Frequency Response and Fourier Transform","url":"http://localhost:4000/notes/frequency-response.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="/assets/css/custom.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Albus&apos;s Control Notes" /><script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      }
    };
  </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>

</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Albus&#39;s Control Notes</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          <a class="page-link" href="/">Home</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <h1 id="frequency-response-and-fourier-transform">Frequency Response and Fourier Transform</h1>

<h2 id="quick-notes-on-damping">Quick Notes on Damping</h2>
<h3 id="underdamped-critically-damped-and-overdamped">Underdamped, Critically damped, and Overdamped</h3>
<p>Underdamped: imgarinary poles</p>

<p>Cirtically damped: repeated poles (eigenvalues)</p>

<p>Overdamped: Real eigenvalues</p>

<p>For a standard second-order transfer function:</p>

\[G(s) = \frac{\omega_n^2}{s^2 + 2\zeta \omega_n s + \omega_n^2}\]

<p>For a standard second-order system:</p>

\[\ddot{y}(t) + 2\zeta \omega_n \dot{y}(t) + \omega_n^2 y(t) = K \omega_n^2 u(t)\]

<hr />

<p>The standard second-order system in differential equation form is:</p>

\[\ddot{y}(t) + 2\zeta \omega_n \dot{y}(t) + \omega_n^2 y(t) = K \omega_n^2 u(t)\]

<p><strong>1. Underdamped</strong> (\(0 &lt; \zeta &lt; 1\)):</p>

\[y(t) = e^{-\zeta \omega_n t} \left[ A \cos\left( \omega_n \sqrt{1 - \zeta^2} \, t \right) 
+ B \sin\left( \omega_n \sqrt{1 - \zeta^2} \, t \right) \right]\]

<p><strong>Critically damped</strong> (\(\zeta = 1\)):</p>

\[y(t) = \left( A + Bt \right) e^{-\omega_n t}\]

<p><strong>Overdamped</strong> (\(\zeta &gt; 1\)):</p>

<p>Let:
\(r_{1,2} = -\omega_n \left( \zeta \pm \sqrt{\zeta^2 - 1} \right)\)</p>

<p>Then:
\(y(t) = A e^{r_1 t} + B e^{r_2 t}\)</p>

<h3 id="damping-in-higher-order-systems">Damping in higher order systems</h3>
<p>Damping behavior is only defined for second order systems. Dominant poles are investigated for general behavior for higher-order systems.</p>
<h3 id="damping-and-bode-plot">Damping and Bode plot</h3>
<p>A peak in the frequency response (magnitude plot) happens when the system has complex conjugate poles that are <strong>lightly damped</strong>.</p>

<hr />

<h2 id="fourier-and-laplace-transforms">Fourier and Laplace Transforms</h2>

<p><strong>Note:</strong> In Laplace domain, \(s=\sigma + j\omega\). When evaluating Laplace Transform at \(s=j\omega\), Laplace Transform becomes Fourier Transform. <strong>when you go from the Laplace transform \(F(s)\) to the Fourier transform \(F(j\omega)\), you’re essentially looking at the steady-state sinusoidal response of the system.</strong></p>

<h3 id="laplace-transform">Laplace Transform</h3>
<p>\(\mathcal{L}\{f(t)\} = F(s) = \int_0^{\infty} e^{-st} f(t) \, dt\)</p>

<p>Laplace Tranform is a generialized form of Fourier Transform. Specifically, Fourier Transform evaluates Laplace Transform at \(i\omega\), with no real parts, ie. Fourier Transform only evaluates purely imaginary arguments for Laplace Transform.
<strong>Inpoulse response</strong> h(t) given \(u = \delta(t)\) is \(L^{-1}{G(s), where Y(s) = G(s)X(s)}\) ie the inverse Laplace Transform of the Transfer function (G(s))</p>
<h3 id="fourier-series">Fourier Series</h3>

<p>If \(f(t)\) is a periodic function with period $T$, its <strong>Fourier series</strong> representation is:</p>

\[f(t) = a_0 + \sum_{n=1}^{\infty} \left[ a_n \cos\left(\frac{2\pi n t}{T}\right) + b_n \sin\left(\frac{2\pi n t}{T}\right) \right]\]

<p>The coefficients are given by:</p>

\[a_0 = \frac{1}{T} \int_{-T/2}^{T/2} f(t) \, dt\]

\[a_n = \frac{2}{T} \int_{-T/2}^{T/2} f(t) \cos\left(\frac{2\pi n t}{T}\right) dt\]

\[b_n = \frac{2}{T} \int_{-T/2}^{T/2} f(t) \sin\left(\frac{2\pi n t}{T}\right) dt\]

<p>You can also write the Fourier series using <strong>complex exponentials</strong>:</p>

\[f(t) = \sum_{n=-\infty}^{\infty} c_n e^{i 2\pi n t / T}\]

<p>with coefficients:</p>

\[c_n = \frac{1}{T} \int_{-T/2}^{T/2} f(t) e^{-i 2\pi n t / T} dt\]

<hr />

<h3 id="fourier-transform">Fourier Transform</h3>

<p>For non-periodic functions, the <strong>Fourier Transform</strong> is used. The <strong>continuous-time Fourier transform (CTFT)</strong> of a function $f(t)$ is:</p>

\[F(\omega) = \int_{-\infty}^{\infty} f(t) e^{-i \omega t} dt\]

<p>The <strong>inverse Fourier transform</strong> is:</p>

\[f(t) = \frac{1}{2\pi} \int_{-\infty}^{\infty} F(\omega) e^{i \omega t} d\omega\]

<p>Alternatively, in terms of frequency \(f\) (Hz) instead of angular frequency $\omega = 2\pi f$:</p>

\[F(f) = \int_{-\infty}^{\infty} f(t) e^{-i 2\pi f t} dt\]

\[f(t) = \int_{-\infty}^{\infty} F(f) e^{i 2\pi f t} df\]

<p><strong>Intuition</strong> Fourier Transform converts a time-domain \(\bar{x}(t)\) to frequency domain \(X(f)\). This investigates how much of this specific frequency exists in the signal.
Fourier Transform returns a complex number.</p>
<ol>
  <li>The magnitude of this number denotes how strong that frequency is in the signal</li>
  <li>The angle of the complex number signifies the phase offset of that frequency - i.e., where that sine wave starts relative to time zero.</li>
</ol>

<hr />

<h2 id="non-minimum-phase">Non-minimum Phase</h2>

<p><strong>Motivation</strong>: For the same magnitude gain plot, phase plots can be drastically different. This is due to the fact that multiple transfer functions can produce the same magnitude gain plot, but have different phase profiles.</p>

<p><strong>Note</strong>: Non-miminum phase can be primarily caused by three phenomena: 1. Time delay \(e^{-sT}\) 2. RHP zeroes 3. Non-causal/Inverse-unstable Dynamics (Non-causal systems depend on input in the future)</p>

<p>Inverse-unstable systems (RHP in zero -&gt; inverse system has RHP pole (unstable inverse))</p>

<p><img src="../figures/nonminimum_phase.png" alt="non-minimum phase systems from time delay and RHP zeroes" />
<img src="../figures/nmp_freqres.png" alt="frequency response for non-minimum phase systems from time delay and RHP zeroes" /></p>

<p>Green curve is for time delay, and red curve is for RHP zero.</p>

<h3 id="why-does-rhp-zeroes-cause-system-to-go-the-opposite-way-first">Why does RHP zeroes cause system to go the opposite way first</h3>

<p>Long story short, RHP zeroes take derivative on the input with the \(-S\) term, which means the derivative has opposite sign from the input, which causes the system to react in the opposite way before correcting.</p>

<p><img src="../figures/rhp_zero_behavior.png" alt="RHP zeroes behavior" /></p>

<h2 id="why-is-rhp-zero-undesirable-and-what-makes-it-hard-to-control">Why is RHP zero undesirable and what makes it hard to control</h2>

<ol>
  <li>
    <p>Moving in the opposite way first slows down the response</p>
  </li>
  <li>
    <p>Increasing the controller gain can make it unstable. (cart keeps going to the left initially because of increased error, which causes increased control effort, which in turn makes the cart keep going in the wrong way before full throttle to the right.)</p>
  </li>
  <li>
    <p>NMP systems have smaller phase margins because of the additional phase lag.</p>
  </li>
  <li>
    <p>NMP systems are more susceptible to the gain. Increasing the gain increases the gain crossover frequency, which decreases phase margin.</p>
  </li>
</ol>

<h3 id="rhp-examples">RHP examples</h3>

<ol>
  <li>
    <p>Inverted pendulum: System: x coordinate of the cart. behavior: the cart goes left first, causing the pendulum to to slightly right, before moving right again and causing the pendulum to balance.</p>
  </li>
  <li>
    <p>Aircraft altitude control: System: altitude of the aircraft. behavior: to gain altitude, the aircraft needs to drop the elevator first before rising.</p>
  </li>
</ol>

<h3 id="how-to-deal-with-rhp-zeroes-with-controller">How to deal with RHP zeroes with controller</h3>

<ol>
  <li>
    <p>Having a pole in the controller that cancels out the zero in the plant is risky since the output of the controller can be unbounded even though the output of the plant (the entire system) can be stable.</p>
  </li>
  <li>
    <p>Predictive or nonlinear controllers</p>
  </li>
  <li>
    <p>Easiest: lower controller gain to maintain stability and increase phase margin.</p>
  </li>
</ol>

<hr />

<h2 id="bode-and-nyquist-plots">Bode and Nyquist Plots</h2>

<h3 id="frequency-response">Frequency Response</h3>
<p><img src="../figures/frequency_response.png" alt="frequency response of a mass-spring damper system" /></p>

<p>\(frac{\bar{x}}{\bar{u}}\)
<strong>Notes:</strong></p>
<ol>
  <li>The bode plots are plotted in log scale. A small bump in Gain plot corresponds to huge response at resonate frequency.</li>
  <li>At extremely low frequency, this system displays no gain at all hence Gain = 0 for low frequencies. At high frequencies, the sytems doesn’t have the capacity to respond in times hence the gain drops asymptotically to zero or $-\infty$ in log scale.</li>
</ol>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Albus&#39;s Control Notes</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Albus&#39;s Control Notes</li><li><a class="u-email" href="mailto:albus.fang.autonomy@gmail.com">albus.fang.autonomy@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
