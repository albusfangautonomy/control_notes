<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Stability Analysis | Albus’s Control Notes</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Stability Analysis" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<meta property="og:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description." />
<link rel="canonical" href="http://localhost:4000/notes/stability.html" />
<meta property="og:url" content="http://localhost:4000/notes/stability.html" />
<meta property="og:site_name" content="Albus’s Control Notes" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Stability Analysis" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.","headline":"Stability Analysis","url":"http://localhost:4000/notes/stability.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="/assets/css/custom.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Albus&apos;s Control Notes" /><script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      }
    };
  </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>

</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Albus&#39;s Control Notes</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          <a class="page-link" href="/">Home</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <h1 id="stability-analysis">Stability Analysis</h1>

<h2 id="stability-margins---gain-and-phase-margins">Stability Margins - Gain and Phase Margins</h2>
<p>In simple terms, Gain and Phase margins are the safe net and the extra that protects us from instability.
less margin = less stable</p>

<p><strong>Note:</strong>
<em>Gain</em> crossover frequency is used to caluclate <em>Phase</em> Margin.</p>

<p><em>Phase</em> crossover frequency is used to caculate <em>Gain</em> Margin.</p>

<p>The Gain and PhaseMargins are <strong>defined with respect to open-loop transfer function</strong>, but the margins are not intrinsic properties of the open-loop system alone, and are only meaningful for the corresponding closed-loop system.</p>

<hr />

<h3 id="gain-margin">Gain Margin</h3>

<p>The gain margin (GM) is defined at the phase crossover frequency 
\(\omega_{pc}  \text{ where } \angle L(j\omega_{pc}) = -180^\circ\):</p>

\[GM = \frac{1}{|L(j\omega_{pc})|}\]

<p>In decibels (dB):</p>

\[GM_{\text{dB}} = -20 \log_{10} |L(j\omega_{pc})|\]

<p>If there are multiple <strong>Phase crossover frequencies \(\omega_{pc}\)</strong>, use the most conservative Gain Margin.</p>

<h3 id="phase-margin">Phase Margin</h3>

<p>The phase margin (PM) is defined at the gain crossover frequency 
\(\omega_{gc}\) where \(|L(j\omega_{gc})| = 1\):</p>

\[PM = 180^\circ + \angle L(j\omega_{gc})\]

<p>Delay in the system (e.g. delay in digital computers) only affects the phase plot and shifts it down.</p>

<h3 id="margins-and-sensitivity">Margins and Sensitivity</h3>

<p>Peaks in Sensitivity Plots are directly correlated with Gain and Phase Margins. The smaller the margins, the bigger the peak.</p>

<h3 id="real-world-cases">Real World Cases</h3>
<ol>
  <li>Changing one parameter in the characteristic equation can have a larger effect than anticipated. Gain and Phase margin only apply separately to a whole open-loop system, and uncertainty in one particular parameter can drastically change the bode plots and therefore the margins.</li>
  <li>The Bode Plots can indicate infinite margins but be cautious about any dips in the phase plot, as the margins are small in those areas.</li>
</ol>

<hr />

<h2 id="why-use-disk-margin">Why use Disk Margin?</h2>
<ol>
  <li>
    <p>Even though increasing delay or increasing gain individually (reducing GM and PM respectively) may not cause the system to be unstable, adding a mix of the two can unstabilize the system. The disk margin therefore needs to be considered. To anaylze the effect of adding phase and gain, use Nyquist Plot.</p>
  </li>
  <li>
    <p>Disk margin can be used on MIMO.</p>
  </li>
</ol>

<h2 id="disk-margin">Disk Margin</h2>

<p><img src="../figures/disk_margin_complex_plane.png" alt="disk margin" width="700" /></p>

<p>The disk reads “Given \(e=0.0\), the maximum disk margin is 0.56”</p>

<h3 id="parameters-of-the-disk">Parameters of the disk</h3>
<p>The disk must be fit entirely in the stable region and includes the nominal point \(f =1 + 0i\)</p>
<ol>
  <li>Skew factor \(e\). how far off the center of the disk is to the nominal point.</li>
  <li>\(\alpha\) measures the size of the disk. It represents the size of the disk given a certain \(e\) such that the disk is entirely in the stable region.</li>
</ol>

<h3 id="disk-placement">Disk Placement</h3>
<p>You can choose where the disk is:</p>

<ol>
  <li>
    <p>If you think real system gain is bigger than model gain, use a bigger \(e\)</p>

    <ul>
      <li>If unsure, choose \(e = 0.0\)</li>
    </ul>
  </li>
  <li>
    <p>Disk margin may not be conservative even if it may only covers a small area of stability zone.</p>

    <p><img src="../figures/disk_margin_conservativeness.png" alt="disk margin conservativeness" width="500" /></p>

    <ul>
      <li>in this case, while gain margin is bigger, at those bigger gain values, not much wiggle room for phase -&gt; not optimal</li>
    </ul>
  </li>
  <li>
    <p>May need to check all three margins to ensure accurate representation of the stability.</p>

    <ul>
      <li>Some systems are robust to pure phase or gain variations but not a mix of the two</li>
    </ul>

    <p><img src="../figures/disk_margin_example.png" alt="disk margin example" width="500" /></p>
  </li>
</ol>

<hr />

<h2 id="closed-loop-stability">Closed Loop Stability</h2>

<p>In a non-unity feedback system whose feedback transfer function is \(H(s)\), the closed loop transfer function is \(\frac{G(s)}{1+GH}\). We can study the stability of the closed loop transfer function by identifying the <strong>zeros</strong> of \(1+GH\).</p>

<p><strong>Adding 1 to the Nyquist plot of the open loop transfer function shift the plot to the right by 1</strong></p>

<hr />

<h2 id="nyquist-criterion--bodenyquist-terms-unity-feedback">Nyquist Criterion — Bode/Nyquist Terms (Unity Feedback)</h2>

<h3 id="cauchys-argument-principle">Cauchy’s Argument Principle</h3>

<p>A <em>contour</em> in S-plane maps to a <em>plot</em> in W-plane. The phaser for any point on the contour is the same as the phaser for its mapped counterpart in the W-plane. The mapping is done by the transfer function.</p>

<p>To compute the phaser:</p>
<ol>
  <li>Choose a point in the S plane.</li>
  <li>Draw phasers by connecting that point of interest to all the zeros and poles in the S-plane.</li>
  <li>To compute the magnitude of the phaser in W-plane, multiply all magnitudes of the zero phasers (<strong>in S-plane</strong>) and divide by the magnitudes of the pole phasers (<strong>in S-plane</strong>).</li>
  <li>To compute the phase of the phaser in W-plane, add the zero phases <strong>in S-plane</strong> and subtract the pole phases <strong>in S-plane</strong>. The phase here refers to the angle between the phaser and the positve x-axis.</li>
</ol>

<p>We use the above method to trace a contour in the S-plane and visualize the plot on the W-plane.</p>

<p><strong>Notes:</strong></p>
<ol>
  <li>Given the above steps, we can see that if the contour does not include any poles or zeroes, the phase in W-plane would never go around \(360^\circ\).</li>
  <li>If the contour encircles a pole, the resulting plot on W-plane circles the origin in the counter clockwise direction. This is because we are subtracting pole phases.</li>
</ol>

<ul>
  <li>for each encircled pole on a contour, there’s a circle around the origin on the plot in W-plane.</li>
</ul>

<ol>
  <li>Encircling a zero in the S-plane does similar things in W-plane but flip the direction to clockwise.</li>
  <li>If there are same number of zeros as poles, the resulting plot in W-plane does not encircle the orgin at all.</li>
</ol>

<p><img src="../figures/s_plane_w_plane_fig1.png" width="300" /> <img src="../figures/s_plane_w_plane_fig2.png" width="300" /></p>

<p>We can get the difference between the number of poles and zeros in the S-plane just by looking at if the plot in W-plane encircles the origin and if so, in what direction.</p>

<ol>
  <li>If the plot in W-plane (ie, after propagating through the transfer function) encircles the origin once in the clockwise direction, there is 1 <strong>more</strong> zero than poles in the original system.</li>
  <li>If the plot in W-plane (ie, after propagating through the transfer function) encircles the origin once in the counter-clockwise direction, there is 1 <strong>more</strong> pole than zeros in the original system.</li>
  <li>If the plot encircles the origin twice in the clockwise direction, there are 2 <strong>more</strong> zeros than poles in the original system.</li>
</ol>

<p><img src="../figures/s_plane_w_plane_fig3.png" width="300" /></p>

<hr />

<h2 id="using-cauchys-argument-principle-for-closed-loop-stability-analysis-are-there-any-zeroes-in-rhp-for-1ls">Using Cauchy’s Argument Principle for Closed-loop Stability Analysis (Are there any zeroes in RHP for \(1+L(s)\))</h2>
<h3 id="why-rhp-zeros-of-1ls">Why RHP zeros of \(1+L(s)\)?</h3>
<ol>
  <li>An open loop system is stable if and only if there is <em>no RHP poles</em>, which happens when the <strong>denominator</strong> of L(s) equals 0.</li>
  <li>Since \(1+L(s)\) is the new denominator of the closed loop transfer function \(\frac{G}{1+GH}\), we want there to be no RHP zeros.</li>
</ol>

<h3 id="using-cauchys-argument-principle-and-nyquist-contour">Using Cauchy’s Argument Principle and Nyquist Contour</h3>
<p>Since we need to know if there is any RHP zeros for \(1+GH\), we need a contour that encloses the right half plane - \(Nyquist contour\) on S-plane.</p>

<p>When the <strong>Nyquist contour</strong> is mapped through a transfer function to the W-plane, we get a <strong>Nyquist plot</strong>. The Nyquist plot is plotted by pluggin in every single frequency on the imaginary axis and all the points along with infinity on the RHP in the S-plane.</p>

<p>Instead of 1+GH, we can shift the plane to the left by -1 and only investigate the <strong>Open-loop</strong> transfer function \(GH\).</p>

<p>By looking at the Nyquist plot, we can see how many times the -1 point is encircled and in which direction.</p>

<p>Steps:</p>
<ol>
  <li>Get Nyquist plot of Open-loop transfer function \(G(s)H(s)\)</li>
  <li>Count encirclements of -1, note direction.</li>
  <li>Determine how many more poles or zeros are in the RHP. We can do this since we typically know how many poles are in the RHP for \(GH\)</li>
</ol>

<p>Therefore,</p>

\[Z=N+P\]

<p>where Z is the number of zeros of \(1+GH\), N is the number of times the Nyquist plot encircles -1 in the clockwise direction, and P is the number of open loop poles in the RHP (unstable open-loop poles)</p>

<p>To guarantee no RHP zeros for \(1+L(s)\), we need to have 1 counterclockwise encirclement for every open-loop RHP pole.</p>

<p>This prperty allows to use Nyquist plots to analyze both stable and unstable open-loop system, unlike the bode plot, which only pertains to stable open loop systems.</p>

<hr />

<h3 id="nyquist-criterion">Nyquist Criterion</h3>

<p><strong>Setup.</strong> Let the open-loop transfer be \(G(s)\) for a unity-feedback loop with closed-loop characteristic \(1+G(s)=0\). Let:</p>
<ul>
  <li>\(P\) = number of open-loop poles of \(G(s)\) in the right-half plane (RHP),</li>
  <li>\(N\) = number of <em>clockwise</em> encirclements of the Nyquist critical point \(-1+0j\) by the Nyquist plot of \(G(j\omega)\) (standard Nyquist contour),</li>
  <li>\(Z\) = number of closed-loop poles in the RHP.</li>
</ul>

<p><strong>General Nyquist criterion.</strong>
\(Z = N + P.\)
The closed loop is <strong>stable</strong> iff \(Z=0\). Equivalently, the Nyquist plot must encircle \(-1\) <strong>clockwise</strong> exactly \(N=-P\) times.</p>

<p><strong>Common special case (open-loop stable, i.e., \(P=0\)).</strong>
If \(G(s)\) has no RHP poles and no poles on the \(j\omega\)-axis (aside from allowable integrators handled with the modified contour), then:</p>
<ul>
  <li>Closed loop is stable <strong>iff</strong> the Nyquist plot of \(G(j\omega)\) <strong>does not encircle</strong> \(-1+0j\) (i.e., \(N=0 \Rightarrow Z=0\)).</li>
</ul>

<hr />

<h3 id="bode-plot-restatements-margins">Bode-plot restatements (margins)</h3>

<p>Let \(\omega_{gc}\) be a gain-crossover frequency 
where \(|G(j\omega_{gc})|=1\), 
and let \(\omega_{pc}\) be a phase-crossover frequency
 where \(\angle G(j\omega_{pc})=-180^\circ\).</p>

<ul>
  <li>
    <p><strong>Phase margin condition (at gain crossover):</strong>
\(|G(j\omega_{gc})|=1 \quad \Rightarrow \quad \angle G(j\omega_{gc}) &gt; -180^\circ\)
(positive phase margin). This ensures the Nyquist plot does <strong>not</strong> cross the real axis at or left of \(-1\).</p>
  </li>
  <li>
    <p><strong>Gain margin condition (at phase crossover):</strong>
\(\angle G(j\omega_{pc})=-180^\circ \quad \Rightarrow \quad |G(j\omega_{pc})| &lt; 1\)
(positive gain margin). This keeps the Nyquist locus inside the unit circle when it is at \(-180^\circ\), avoiding the point \(-1\).</p>
  </li>
</ul>

<p>If <strong>both</strong> conditions hold for all relevant crossovers and \(P=0\), the loop has positive stability margins and the closed loop is stable.</p>

<hr />

<h3 id="notescaveats">Notes/Caveats</h3>

<ul>
  <li>If \(P&gt;0\) (open-loop unstable), you <strong>must</strong> have exactly \(N=-P\) clockwise encirclements of \(-1\). Simple “margin checks” at crossovers are insufficient without accounting for \(P\).</li>
  <li>Poles on the imaginary axis (e.g., pure integrators) require the standard indentation in the Nyquist contour; apply the modified criterion accordingly.</li>
  <li>The above statements presume unity feedback; for non-unity feedback, apply the criterion to the appropriate open-loop function that multiplies the feedback path.</li>
</ul>


      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Albus&#39;s Control Notes</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Albus&#39;s Control Notes</li><li><a class="u-email" href="mailto:albus.fang.autonomy@gmail.com">albus.fang.autonomy@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/jekyll"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jekyll</span></a></li><li><a href="https://www.twitter.com/jekyllrb"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">jekyllrb</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
